# å‰µä¸–ç´€å…ƒï¼šå¢å¼·å¼AIçºŒå¯«ç³»çµ± - å®Œæ•´æŠ€è¡“æŒ‡å—

## ç³»çµ±æ¦‚è¿°

å‰µä¸–ç´€å…ƒå¢å¼·å¼AIçºŒå¯«ç³»çµ±æ˜¯ä¸€å€‹å°ˆç‚ºé•·ç¯‡å°èªªå‰µä½œè¨­è¨ˆçš„ç¶œåˆæ€§AIå¯«ä½œåŠ©æ‰‹ã€‚ç³»çµ±æ•´åˆäº†å¤šå€‹å…ˆé€²çš„AIæŠ€è¡“çµ„ä»¶ï¼Œæä¾›å…¨é¢çš„å¯«ä½œæ”¯æ´ï¼ŒåŒ…æ‹¬æ™ºèƒ½ä¸Šä¸‹æ–‡ç®¡ç†ã€è§’è‰²ä¸€è‡´æ€§è¿½è¹¤ã€æƒ…ç¯€é€£è²«æ€§æª¢æŸ¥å’Œè¶…é•·å…§å®¹å„ªåŒ–è™•ç†ã€‚

### æ ¸å¿ƒç‰¹è‰²
- ğŸ§  **æ™ºèƒ½ä¸Šä¸‹æ–‡ç®¡ç†** - å‹•æ…‹æ§‹å»ºå’Œå„ªåŒ–å¯«ä½œä¸Šä¸‹æ–‡
- ğŸ‘¥ **è§’è‰²ä¸€è‡´æ€§è¿½è¹¤** - å¯¦æ™‚ç›£æ§è§’è‰²è¡Œç‚ºå’Œèªè¨€é¢¨æ ¼
- ğŸ“– **æƒ…ç¯€é€£è²«æ€§æª¢æŸ¥** - ç¢ºä¿æ•…äº‹é‚è¼¯å’Œæ™‚é–“ç·šçš„ä¸€è‡´æ€§
- ğŸ”„ **è¶…é•·ä¸Šä¸‹æ–‡å„ªåŒ–** - æ™ºèƒ½è™•ç†è¶…étokené™åˆ¶çš„é•·ç¯‡å…§å®¹
- ğŸ“Š **å…¨é¢å“è³ªè©•ä¼°** - å¤šç¶­åº¦åˆ†æç”Ÿæˆå…§å®¹çš„å“è³ª
- âš¡ **å¯¦æ™‚æ€§èƒ½ç›£æ§** - è¿½è¹¤ç³»çµ±æ€§èƒ½å’Œç”Ÿæˆå“è³ª

## æ¶æ§‹è¨­è¨ˆ

### ç³»çµ±çµ„ä»¶åœ–

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                æ•´åˆå¼AIçºŒå¯«ç³»çµ±                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  æ™ºèƒ½ä¸Šä¸‹æ–‡ç®¡ç†å™¨  â”‚  â”‚  è§’è‰²ä¸€è‡´æ€§è¿½è¹¤å™¨  â”‚  â”‚  æƒ…ç¯€é€£è²«æ€§ç³»çµ±   â”‚ â”‚
â”‚  â”‚                â”‚  â”‚                â”‚  â”‚                â”‚ â”‚
â”‚  â”‚ â€¢ åˆ†å±¤ä¸Šä¸‹æ–‡æ§‹å»º  â”‚  â”‚ â€¢ è§’è‰²æª”æ¡ˆç®¡ç†    â”‚  â”‚ â€¢ æ™‚é–“è»¸ç®¡ç†      â”‚ â”‚
â”‚  â”‚ â€¢ å‹•æ…‹å…§å®¹é¸æ“‡    â”‚  â”‚ â€¢ èªè¨€é¢¨æ ¼åˆ†æ    â”‚  â”‚ â€¢ å› æœé—œä¿‚éˆ      â”‚ â”‚
â”‚  â”‚ â€¢ é‡è¦æ€§è©•åˆ†      â”‚  â”‚ â€¢ è¡Œç‚ºæ¨¡å¼è¿½è¹¤    â”‚  â”‚ â€¢ ä¼ç­†è¿½è¹¤ç³»çµ±    â”‚ â”‚
â”‚  â”‚ â€¢ èªç¾©ç›¸é—œæ€§åˆ†æ  â”‚  â”‚ â€¢ çŸ¥è­˜ç‹€æ…‹ç®¡ç†    â”‚  â”‚ â€¢ æƒ…ç¯€ç·šç®¡ç†      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ è¶…é•·ä¸Šä¸‹æ–‡å„ªåŒ–å™¨  â”‚  â”‚   å“è³ªè©•ä¼°å™¨     â”‚  â”‚   æ€§èƒ½ç›£æ§å™¨     â”‚ â”‚
â”‚  â”‚                â”‚  â”‚                â”‚  â”‚                â”‚ â”‚
â”‚  â”‚ â€¢ åˆ†å±¤å£“ç¸®ç­–ç•¥    â”‚  â”‚ â€¢ å¤šç¶­å“è³ªåˆ†æ    â”‚  â”‚ â€¢ å¯¦æ™‚æ€§èƒ½è¿½è¹¤    â”‚ â”‚
â”‚  â”‚ â€¢ æ³¨æ„åŠ›æ©Ÿåˆ¶      â”‚  â”‚ â€¢ å‰µæ„åº¦è©•ä¼°      â”‚  â”‚ â€¢ è³‡æºä½¿ç”¨ç›£æ§    â”‚ â”‚
â”‚  â”‚ â€¢ å…§å®¹å¡Šç®¡ç†      â”‚  â”‚ â€¢ æ–‡å­¸åƒ¹å€¼åˆ†æ    â”‚  â”‚ â€¢ æˆåŠŸç‡çµ±è¨ˆ      â”‚ â”‚
â”‚  â”‚ â€¢ æ™ºèƒ½å¿«å–ç³»çµ±    â”‚  â”‚ â€¢ æ”¹é€²å»ºè­°ç”Ÿæˆ    â”‚  â”‚ â€¢ å“è³ªè¶¨å‹¢åˆ†æ    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### è³‡æ–™æ¨¡å‹å¢å¼·

#### æ–°å¢è³‡æ–™è¡¨çµæ§‹

```sql
-- ä¸–ç•Œè¨­å®šç®¡ç†
CREATE TABLE world_settings (
    id TEXT PRIMARY KEY,
    project_id TEXT NOT NULL,
    category TEXT NOT NULL,  -- 'magic_system', 'world_rules', 'geography', 'culture'
    name TEXT NOT NULL,
    description TEXT NOT NULL,
    importance_level INTEGER DEFAULT 5,  -- 1-10
    usage_count INTEGER DEFAULT 0,
    last_used DATETIME,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (project_id) REFERENCES projects(id)
);

-- è§’è‰²ç‹€æ…‹æ™‚é–“è»¸
CREATE TABLE character_states (
    id TEXT PRIMARY KEY,
    character_id TEXT NOT NULL,
    chapter_id TEXT NOT NULL,
    position INTEGER NOT NULL,
    emotional_state TEXT,
    physical_state TEXT,
    knowledge_state TEXT,  -- JSON array
    goals TEXT,  -- JSON array
    location TEXT,
    relationships_snapshot TEXT,  -- JSON object
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (character_id) REFERENCES characters(id),
    FOREIGN KEY (chapter_id) REFERENCES chapters(id)
);

-- è§’è‰²èªè¨€é¢¨æ ¼æ¨¡å¼
CREATE TABLE character_speech_patterns (
    id TEXT PRIMARY KEY,
    character_id TEXT NOT NULL,
    vocabulary_style TEXT,  -- JSON array
    sentence_patterns TEXT,  -- JSON array
    emotional_expressions TEXT,  -- JSON object
    catchphrases TEXT,  -- JSON array
    formality_level TEXT DEFAULT 'casual',
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (character_id) REFERENCES characters(id)
);

-- æƒ…ç¯€è¦é»è¿½è¹¤
CREATE TABLE plot_points (
    id TEXT PRIMARY KEY,
    project_id TEXT NOT NULL,
    chapter_id TEXT NOT NULL,
    position INTEGER NOT NULL,
    plot_type TEXT NOT NULL,  -- 'setup', 'conflict', 'climax', 'resolution'
    title TEXT NOT NULL,
    description TEXT NOT NULL,
    importance INTEGER DEFAULT 5,  -- 1-10
    status TEXT DEFAULT 'introduced',  -- 'introduced', 'developing', 'resolved'
    related_characters TEXT,  -- JSON array of character IDs
    foreshadowing_target TEXT,  -- Reference to target plot point
    resolution_target TEXT,  -- Reference to corresponding setup
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (project_id) REFERENCES projects(id),
    FOREIGN KEY (chapter_id) REFERENCES chapters(id)
);

-- ä¸Šä¸‹æ–‡å¿«å–
CREATE TABLE context_cache (
    id TEXT PRIMARY KEY,
    project_id TEXT NOT NULL,
    chapter_id TEXT NOT NULL,
    position INTEGER NOT NULL,
    content_hash TEXT NOT NULL,
    compressed_content TEXT NOT NULL,
    original_length INTEGER NOT NULL,
    compressed_length INTEGER NOT NULL,
    compression_level INTEGER DEFAULT 1,
    quality_score REAL DEFAULT 1.0,
    access_count INTEGER DEFAULT 0,
    last_accessed DATETIME DEFAULT CURRENT_TIMESTAMP,
    expiry_time DATETIME,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (project_id) REFERENCES projects(id),
    FOREIGN KEY (chapter_id) REFERENCES chapters(id)
);
```

## æ ¸å¿ƒåŠŸèƒ½è©³è§£

### 1. æ™ºèƒ½ä¸Šä¸‹æ–‡ç®¡ç†ç³»çµ±

#### åŠŸèƒ½ç‰¹è‰²
- **åˆ†å±¤ä¸Šä¸‹æ–‡æ§‹å»º**: å°‡ä¸Šä¸‹æ–‡åˆ†ç‚ºæ ¸å¿ƒå±¤ã€èƒŒæ™¯å±¤ã€æ­·å²å±¤ã€ä¸–ç•Œå±¤
- **å‹•æ…‹å…§å®¹é¸æ“‡**: åŸºæ–¼ç›¸é—œæ€§å’Œé‡è¦æ€§æ™ºèƒ½é¸æ“‡å…§å®¹
- **èªç¾©åˆ†æ**: ä½¿ç”¨èªç¾©ç›¸ä¼¼åº¦å„ªåŒ–å…§å®¹é¸æ“‡
- **é‡è¦æ€§è©•åˆ†**: å¤šç¶­åº¦è©•ä¼°å…§å®¹é‡è¦æ€§

#### ä½¿ç”¨ç¤ºä¾‹
```rust
let context_manager = IntelligentContextManager::new(4000);
let context = context_manager.build_intelligent_context(
    "project_id",
    "chapter_id", 
    position,
    &["ä¸»è§’", "åæ´¾"]
).await?;
```

#### é…ç½®é¸é …
```rust
pub struct CompressionStrategy {
    pub core_context_ratio: f32,        // 40% çµ¦æ ¸å¿ƒä¸Šä¸‹æ–‡
    pub character_context_ratio: f32,   // 25% çµ¦è§’è‰²
    pub plot_context_ratio: f32,        // 20% çµ¦æƒ…ç¯€
    pub world_context_ratio: f32,       // 10% çµ¦ä¸–ç•Œè¨­å®š
    pub historical_context_ratio: f32,  // 5% çµ¦æ­·å²
}
```

### 2. è§’è‰²ä¸€è‡´æ€§è¿½è¹¤æ©Ÿåˆ¶

#### åŠŸèƒ½ç‰¹è‰²
- **è§’è‰²æª”æ¡ˆç®¡ç†**: è©³ç´°è¨˜éŒ„è§’è‰²çš„å„é …å±¬æ€§å’Œç‰¹å¾µ
- **èªè¨€é¢¨æ ¼åˆ†æ**: è¿½è¹¤è§’è‰²çš„èªªè©±æ–¹å¼å’Œè©å½™ä½¿ç”¨
- **è¡Œç‚ºæ¨¡å¼è¿½è¹¤**: ç›£æ§è§’è‰²çš„è¡Œç‚ºä¸€è‡´æ€§
- **çŸ¥è­˜ç‹€æ…‹ç®¡ç†**: è¿½è¹¤è§’è‰²çŸ¥é“å’Œä¸çŸ¥é“çš„è³‡è¨Š
- **æˆé•·è»Œè·¡è¨˜éŒ„**: è¨˜éŒ„è§’è‰²åœ¨æ•…äº‹ä¸­çš„è®ŠåŒ–

#### è§’è‰²æª”æ¡ˆçµæ§‹
```rust
pub struct CharacterProfile {
    pub core_traits: Vec<String>,           // æ ¸å¿ƒæ€§æ ¼ç‰¹å¾µ
    pub speech_patterns: SpeechPatterns,    // èªè¨€æ¨¡å¼
    pub behavioral_patterns: BehavioralPatterns,  // è¡Œç‚ºæ¨¡å¼
    pub knowledge_base: KnowledgeBase,      // çŸ¥è­˜åº«
    pub emotional_profile: EmotionalProfile, // æƒ…æ„Ÿæª”æ¡ˆ
    pub relationship_dynamics: HashMap<String, RelationshipDynamic>, // é—œä¿‚å‹•æ…‹
    pub growth_trajectory: Vec<CharacterGrowthPoint>, // æˆé•·è»Œè·¡
}
```

#### ä¸€è‡´æ€§æª¢æŸ¥
```rust
let analysis = character_tracker.analyze_character_consistency(
    generated_text,
    "character_id",
    &context
).await?;

println!("èªè¨€ä¸€è‡´æ€§: {}", analysis.speech_consistency);
println!("è¡Œç‚ºä¸€è‡´æ€§: {}", analysis.behavior_consistency);
println!("çŸ¥è­˜ä¸€è‡´æ€§: {}", analysis.knowledge_consistency);
```

### 3. æƒ…ç¯€é€£è²«æ€§æª¢æŸ¥ç³»çµ±

#### åŠŸèƒ½ç‰¹è‰²
- **æ™‚é–“è»¸ç®¡ç†**: ç¢ºä¿äº‹ä»¶æŒ‰æ­£ç¢ºçš„æ™‚é–“é †åºç™¼ç”Ÿ
- **å› æœé—œä¿‚éˆ**: è¿½è¹¤äº‹ä»¶ä¹‹é–“çš„å› æœé—œä¿‚
- **ä¼ç­†è¿½è¹¤ç³»çµ±**: ç®¡ç†ä¼ç­†çš„è¨­ç½®å’Œè§£ç­”
- **æƒ…ç¯€ç·šç®¡ç†**: ç›£æ§ä¸»ç·šå’Œæ”¯ç·šçš„ç™¼å±•
- **é‚è¼¯ä¸€è‡´æ€§æª¢æŸ¥**: ç™¼ç¾å’Œä¿®æ­£é‚è¼¯æ¼æ´

#### æ™‚é–“è»¸äº‹ä»¶çµæ§‹
```rust
pub struct TimelineEvent {
    pub story_time: StoryTime,              // æ•…äº‹æ™‚é–“
    pub event_type: String,                 // äº‹ä»¶é¡å‹
    pub characters_involved: Vec<String>,   // æ¶‰åŠè§’è‰²
    pub consequences: Vec<String>,          // äº‹ä»¶å¾Œæœ
    pub causal_links: Vec<String>,         // å› æœéˆæ¥
}
```

#### æƒ…ç¯€æª¢æŸ¥ç¤ºä¾‹
```rust
let coherence_analysis = plot_system.analyze_plot_coherence(
    new_content,
    chapter_id,
    position
).await?;

if coherence_analysis.overall_score < 0.7 {
    println!("ç™¼ç¾æƒ…ç¯€é€£è²«æ€§å•é¡Œ: {:?}", coherence_analysis.issues);
}
```

### 4. è¶…é•·ä¸Šä¸‹æ–‡å„ªåŒ–è™•ç†

#### åŠŸèƒ½ç‰¹è‰²
- **åˆ†å±¤å£“ç¸®ç­–ç•¥**: æ ¹æ“šå…§å®¹é‡è¦æ€§é€²è¡Œåˆ†å±¤å£“ç¸®
- **æ³¨æ„åŠ›æ©Ÿåˆ¶**: æ¨¡æ“¬äººé¡æ³¨æ„åŠ›ï¼Œé‡é»é—œæ³¨ç›¸é—œå…§å®¹
- **å…§å®¹å¡Šç®¡ç†**: å°‡å…§å®¹åˆ†è§£ç‚ºå¯ç®¡ç†çš„å¡Šç‹€çµæ§‹
- **æ™ºèƒ½å¿«å–ç³»çµ±**: å¿«å–å¸¸ç”¨çš„å£“ç¸®çµæœ
- **å“è³ªä¿è­·**: ç¢ºä¿å£“ç¸®éç¨‹ä¸æå¤±é—œéµè³‡è¨Š

#### å£“ç¸®ç­‰ç´šé…ç½®
```rust
pub struct CompressionLevel {
    pub level: u8,                    // 1-5ï¼Œå£“ç¸®ç¨‹åº¦
    pub compression_ratio: f32,       // å£“ç¸®æ¯”ä¾‹
    pub quality_loss: f32,           // å“è³ªæå¤±ç¨‹åº¦
    pub strategies: Vec<CompressionStrategy>, // å£“ç¸®ç­–ç•¥
}
```

#### ä½¿ç”¨ç¤ºä¾‹
```rust
let optimizer = UltraLongContextOptimizer::new(8000);
let optimized = optimizer.optimize_ultra_long_context(
    original_context,
    &focus_characters,
    current_position
).await?;

println!("å£“ç¸®æ¯”ä¾‹: {}", optimized.compression_ratio);
println!("å“è³ªåˆ†æ•¸: {}", optimized.quality_score);
```

## API ä½¿ç”¨æŒ‡å—

### ä¸»è¦APIç«¯é»

#### 1. å®Œæ•´AIçºŒå¯«
```rust
#[command]
pub async fn comprehensive_ai_writing(
    project_id: String,
    chapter_id: String,
    position: usize,
    model: String,
    config: Option<AIWritingConfig>,
    additional_params: Option<HashMap<String, serde_json::Value>>,
) -> Result<ComprehensiveWritingResponse, String>
```

**ä½¿ç”¨ç¤ºä¾‹**:
```javascript
const response = await api.ai.comprehensiveAIWriting(
    "project-123",
    "chapter-456", 
    1500,
    "llama3.2",
    {
        maxTokens: 4000,
        temperature: 0.7,
        enableConsistencyCheck: true,
        enablePlotCoherenceCheck: true
    }
);

console.log("ç”Ÿæˆå…§å®¹:", response.generatedText);
console.log("å“è³ªåˆ†æ:", response.qualityAnalysis);
console.log("ä¸€è‡´æ€§åˆ†æ:", response.consistencyAnalysis);
```

#### 2. è§’è‰²ä¸€è‡´æ€§åˆ†æ
```rust
#[command]
pub async fn analyze_character_consistency_command(
    project_id: String,
    character_id: String,
    text: String,
    context: IntelligentContext,
) -> Result<CharacterConsistencyAnalysis, String>
```

#### 3. æƒ…ç¯€é€£è²«æ€§æª¢æŸ¥
```rust
#[command]
pub async fn analyze_plot_coherence_command(
    project_id: String,
    chapter_id: String,
    position: usize,
    content: String,
) -> Result<PlotCoherenceAnalysis, String>
```

#### 4. ä¸Šä¸‹æ–‡å„ªåŒ–
```rust
#[command]
pub async fn optimize_ultra_long_context_command(
    original_context: String,
    max_tokens: usize,
    focus_characters: Vec<String>,
    current_position: usize,
) -> Result<OptimizedContext, String>
```

### å‰ç«¯æ•´åˆ

#### React Hook ç¤ºä¾‹
```typescript
import { useAIWriting } from './hooks/useAIWriting';

const AIWritingComponent = () => {
    const { 
        generateContent, 
        isLoading, 
        lastResponse,
        error 
    } = useAIWriting();

    const handleGenerate = async () => {
        try {
            const response = await generateContent({
                projectId: "current-project",
                chapterId: "current-chapter",
                position: cursorPosition,
                model: "llama3.2",
                config: {
                    temperature: 0.7,
                    maxTokens: 4000,
                    enableConsistencyCheck: true
                }
            });
            
            setGeneratedContent(response.generatedText);
            setQualityMetrics(response.qualityAnalysis);
        } catch (err) {
            console.error("ç”Ÿæˆå¤±æ•—:", err);
        }
    };

    return (
        <div>
            <button onClick={handleGenerate} disabled={isLoading}>
                {isLoading ? "ç”Ÿæˆä¸­..." : "AIçºŒå¯«"}
            </button>
            
            {lastResponse && (
                <div>
                    <div>å“è³ªåˆ†æ•¸: {lastResponse.qualityAnalysis.overallQuality}</div>
                    <div>ä¸€è‡´æ€§åˆ†æ•¸: {lastResponse.consistencyAnalysis.overallConsistency}</div>
                </div>
            )}
        </div>
    );
};
```

## é…ç½®é¸é …

### ç³»çµ±é…ç½®
```rust
pub struct AIWritingConfig {
    // åŸºæœ¬åƒæ•¸
    pub max_tokens: usize,              // æœ€å¤§tokenæ•¸
    pub temperature: f32,               // å‰µæ„åº¦ (0.0-1.0)
    pub top_p: f32,                    // æ ¸æ¡æ¨£åƒæ•¸
    pub presence_penalty: f32,          // å­˜åœ¨æ‡²ç½°
    pub frequency_penalty: f32,         // é »ç‡æ‡²ç½°
    
    // å“è³ªæ§åˆ¶
    pub min_consistency_score: f32,     // æœ€ä½ä¸€è‡´æ€§åˆ†æ•¸
    pub enable_consistency_check: bool, // å•Ÿç”¨ä¸€è‡´æ€§æª¢æŸ¥
    pub enable_plot_coherence_check: bool, // å•Ÿç”¨æƒ…ç¯€æª¢æŸ¥
    pub enable_character_tracking: bool,   // å•Ÿç”¨è§’è‰²è¿½è¹¤
    pub enable_context_optimization: bool, // å•Ÿç”¨ä¸Šä¸‹æ–‡å„ªåŒ–
    
    // å…§å®¹åå¥½
    pub preferred_genres: Vec<String>,     // åå¥½é¡å‹
    pub writing_style: String,            // å¯«ä½œé¢¨æ ¼
    pub narrative_perspective: String,    // æ•˜äº‹è¦–è§’
    pub tone_preferences: Vec<String>,    // èªèª¿åå¥½
    
    // é«˜ç´šè¨­å®š
    pub context_window_size: usize,           // ä¸Šä¸‹æ–‡çª—å£å¤§å°
    pub compression_aggressiveness: f32,      // å£“ç¸®æ¿€é€²ç¨‹åº¦
    pub character_consistency_weight: f32,    // è§’è‰²ä¸€è‡´æ€§æ¬Šé‡
    pub plot_consistency_weight: f32,         // æƒ…ç¯€ä¸€è‡´æ€§æ¬Šé‡
    pub creativity_vs_consistency: f32,       // å‰µæ„èˆ‡ä¸€è‡´æ€§å¹³è¡¡
}
```

### é è¨­é…ç½®ç¯„ä¾‹
```rust
impl Default for AIWritingConfig {
    fn default() -> Self {
        Self {
            max_tokens: 4000,
            temperature: 0.7,
            top_p: 0.9,
            presence_penalty: 0.1,
            frequency_penalty: 0.1,
            min_consistency_score: 0.7,
            enable_consistency_check: true,
            enable_plot_coherence_check: true,
            enable_character_tracking: true,
            enable_context_optimization: true,
            preferred_genres: vec!["è¼•å°èªª".to_string()],
            writing_style: "literary".to_string(),
            narrative_perspective: "third_limited".to_string(),
            tone_preferences: vec!["dramatic".to_string()],
            context_window_size: 8000,
            compression_aggressiveness: 0.3,
            character_consistency_weight: 0.4,
            plot_consistency_weight: 0.6,
            creativity_vs_consistency: 0.7,
        }
    }
}
```

## æ€§èƒ½å„ªåŒ–

### å¿«å–ç­–ç•¥
- **ä¸Šä¸‹æ–‡å¿«å–**: å¿«å–å¸¸ç”¨çš„ä¸Šä¸‹æ–‡çµ„åˆ
- **è§’è‰²æª”æ¡ˆå¿«å–**: å¿«å–è§’è‰²ä¸€è‡´æ€§åˆ†æçµæœ
- **å£“ç¸®çµæœå¿«å–**: å¿«å–ä¸Šä¸‹æ–‡å£“ç¸®çµæœ
- **å“è³ªè©•ä¼°å¿«å–**: å¿«å–å“è³ªåˆ†æçµæœ

### è³‡æºç®¡ç†
- **è¨˜æ†¶é«”ä½¿ç”¨ç›£æ§**: å¯¦æ™‚ç›£æ§è¨˜æ†¶é«”ä½¿ç”¨æƒ…æ³
- **åƒåœ¾å›æ”¶å„ªåŒ–**: å®šæœŸæ¸…ç†éæœŸçš„å¿«å–è³‡æ–™
- **æ‰¹æ¬¡è™•ç†**: æ‰¹æ¬¡è™•ç†å¤šå€‹è«‹æ±‚ä»¥æé«˜æ•ˆç‡
- **éåŒæ­¥è™•ç†**: ä½¿ç”¨éåŒæ­¥è™•ç†é¿å…é˜»å¡UI

### æ€§èƒ½ç›£æ§æŒ‡æ¨™
```rust
pub struct PerformanceMetrics {
    pub total_processing_time: u64,    // ç¸½è™•ç†æ™‚é–“
    pub context_building_time: u64,    // ä¸Šä¸‹æ–‡æ§‹å»ºæ™‚é–“
    pub consistency_check_time: u64,   // ä¸€è‡´æ€§æª¢æŸ¥æ™‚é–“
    pub generation_time: u64,          // ç”Ÿæˆæ™‚é–“
    pub post_processing_time: u64,     // å¾Œè™•ç†æ™‚é–“
    pub tokens_processed: usize,       // è™•ç†çš„tokenæ•¸
    pub tokens_generated: usize,       // ç”Ÿæˆçš„tokenæ•¸
    pub memory_usage_mb: f32,         // è¨˜æ†¶é«”ä½¿ç”¨é‡
}
```

## æ•…éšœæ’é™¤

### å¸¸è¦‹å•é¡Œ

#### 1. ç”Ÿæˆé€Ÿåº¦æ…¢
**åŸå› **: ä¸Šä¸‹æ–‡éé•·æˆ–å•Ÿç”¨äº†å¤ªå¤šæª¢æŸ¥åŠŸèƒ½
**è§£æ±ºæ–¹æ¡ˆ**:
- é™ä½ `context_window_size`
- å¢åŠ  `compression_aggressiveness`
- é¸æ“‡æ€§åœç”¨æŸäº›æª¢æŸ¥åŠŸèƒ½

#### 2. ä¸€è‡´æ€§åˆ†æ•¸ä½
**åŸå› **: è§’è‰²è¨­å®šä¸å®Œæ•´æˆ–æƒ…ç¯€é‚è¼¯æœ‰å•é¡Œ
**è§£æ±ºæ–¹æ¡ˆ**:
- å®Œå–„è§’è‰²è¨­å®šæª”æ¡ˆ
- æª¢æŸ¥æƒ…ç¯€é»è¨­å®š
- èª¿æ•´ä¸€è‡´æ€§æ¬Šé‡

#### 3. è¨˜æ†¶é«”ä½¿ç”¨éé«˜
**åŸå› **: å¿«å–è³‡æ–™éå¤šæˆ–ä¸Šä¸‹æ–‡éå¤§
**è§£æ±ºæ–¹æ¡ˆ**:
- æ¸…ç†éæœŸå¿«å–
- æ¸›å°‘ä¸Šä¸‹æ–‡å¤§å°
- å•Ÿç”¨æ›´æ¿€é€²çš„å£“ç¸®

#### 4. ç”Ÿæˆå…§å®¹å“è³ªä¸ä½³
**åŸå› **: æ¨¡å‹åƒæ•¸è¨­å®šä¸ç•¶æˆ–ä¸Šä¸‹æ–‡è³‡è¨Šä¸è¶³
**è§£æ±ºæ–¹æ¡ˆ**:
- èª¿æ•´ `temperature` å’Œ `top_p` åƒæ•¸
- å¢åŠ è§’è‰²å’Œæƒ…ç¯€è³‡è¨Š
- ä½¿ç”¨æ›´å¥½çš„AIæ¨¡å‹

### é™¤éŒ¯æ¨¡å¼
```rust
// å•Ÿç”¨è©³ç´°æ—¥èªŒ
log::set_max_level(log::LevelFilter::Debug);

// æ€§èƒ½åˆ†æ
let start = Instant::now();
let result = system.generate_with_full_analysis(...).await?;
let duration = start.elapsed();
log::info!("ç”Ÿæˆè€—æ™‚: {:?}", duration);

// è¨˜æ†¶é«”ä½¿ç”¨åˆ†æ
let memory_usage = system.get_memory_usage();
log::info!("è¨˜æ†¶é«”ä½¿ç”¨: {:.2} MB", memory_usage);
```

## æœªä¾†ç™¼å±•è¦åŠƒ

### çŸ­æœŸè¨ˆåŠƒ (v1.1)
1. **å¤šèªè¨€æ”¯æ´**: æ”¯æ´è‹±æ–‡ã€æ—¥æ–‡ç­‰å…¶ä»–èªè¨€çš„å°èªªå‰µä½œ
2. **æ›´å¤šæ–‡å­¸é¡å‹**: å¢åŠ ç§‘å¹»ã€å¥‡å¹»ã€ç¾å¯¦ä¸»ç¾©ç­‰é¡å‹çš„å°ˆé–€æ”¯æ´
3. **å”ä½œå¯«ä½œ**: æ”¯æ´å¤šäººå”ä½œå‰µä½œåŠŸèƒ½
4. **ç‰ˆæœ¬æ§åˆ¶**: æä¾›å…§å®¹ç‰ˆæœ¬ç®¡ç†å’Œå›æ»¾åŠŸèƒ½

### ä¸­æœŸè¨ˆåŠƒ (v2.0)
1. **è¦–è¦ºåŒ–æƒ…ç¯€åœ–**: æä¾›äº’å‹•å¼æƒ…ç¯€çµæ§‹è¦–è¦ºåŒ–
2. **æ™ºèƒ½ç·¨è¼¯å»ºè­°**: åŸºæ–¼æ–‡å­¸ç†è«–æä¾›ç·¨è¼¯å»ºè­°
3. **è®€è€…åé¥‹æ•´åˆ**: æ•´åˆè®€è€…åé¥‹é€²è¡Œå…§å®¹å„ªåŒ–
4. **ç™¼å¸ƒç®¡ç†**: ç›´æ¥æ•´åˆåˆ°ç™¼å¸ƒå¹³å°

### é•·æœŸè¨ˆåŠƒ (v3.0)
1. **å¤šæ¨¡æ…‹å‰µä½œ**: æ”¯æ´åœ–åƒã€éŸ³é »ç­‰å¤šåª’é«”å…§å®¹å‰µä½œ
2. **å€‹æ€§åŒ–AI**: ç‚ºæ¯ä½ä½œè€…è¨“ç·´å°ˆå±¬çš„AIåŠ©æ‰‹
3. **å¸‚å ´åˆ†æ**: æä¾›ä½œå“å¸‚å ´æ½›åŠ›åˆ†æ
4. **æ™ºèƒ½ç¿»è­¯**: é«˜å“è³ªçš„å¤šèªè¨€ç¿»è­¯åŠŸèƒ½

## ç¸½çµ

å‰µä¸–ç´€å…ƒå¢å¼·å¼AIçºŒå¯«ç³»çµ±ä»£è¡¨äº†AIè¼”åŠ©å‰µä½œçš„æœ€æ–°ç™¼å±•ï¼Œå®ƒä¸åƒ…æä¾›äº†å¼·å¤§çš„æ–‡æœ¬ç”Ÿæˆèƒ½åŠ›ï¼Œæ›´é‡è¦çš„æ˜¯å»ºç«‹äº†ä¸€å¥—å®Œæ•´çš„å“è³ªä¿è­‰å’Œä¸€è‡´æ€§ç®¡ç†æ©Ÿåˆ¶ã€‚é€™å¥—ç³»çµ±ç‰¹åˆ¥é©åˆé•·ç¯‡å°èªªçš„å‰µä½œï¼Œèƒ½å¤ å¹«åŠ©ä½œè€…ç¶­æŒè¤‡é›œæ•…äº‹çš„é€£è²«æ€§å’Œè§’è‰²çš„ä¸€è‡´æ€§ã€‚

é€šéåˆç†çš„é…ç½®å’Œä½¿ç”¨ï¼Œé€™å¥—ç³»çµ±å¯ä»¥é¡¯è‘—æé«˜å‰µä½œæ•ˆç‡å’Œä½œå“å“è³ªï¼ŒåŒæ™‚ç‚ºä½œè€…æä¾›æœ‰åƒ¹å€¼çš„å‰µä½œè¦‹è§£å’Œå»ºè­°ã€‚æœªä¾†æˆ‘å€‘å°‡ç¹¼çºŒå„ªåŒ–å’Œæ“´å±•é€™å¥—ç³»çµ±ï¼Œä½¿å…¶æˆç‚ºä½œå®¶å’Œå…§å®¹å‰µä½œè€…ä¸å¯æˆ–ç¼ºçš„å‰µä½œå¤¥ä¼´ã€‚

---

**æŠ€è¡“æ”¯æ´**: å¦‚æœ‰æŠ€è¡“å•é¡Œï¼Œè«‹æŸ¥é–±ç³»çµ±æ—¥èªŒæˆ–è¯ç¹«é–‹ç™¼åœ˜éšŠã€‚
**æ›´æ–°è³‡è¨Š**: è«‹å®šæœŸæª¢æŸ¥ç³»çµ±æ›´æ–°ï¼Œä»¥ç²å¾—æœ€æ–°åŠŸèƒ½å’Œæ€§èƒ½æ”¹é€²ã€‚